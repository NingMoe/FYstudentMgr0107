

@{
    ViewBag.Title ="课程管理";
}

<div ng-controller="courseCtrl">
    <div id="topLayer">
        @*<!--ko if:isShow--><div class="link_topLayer" id="js_topLayer">
                <!--target="_blank" data-bind="click:event"--><div class="toplayer" style="height: 100px;">
                    <!--data-bind="background"--><div class="toplayer-close" data-bind="click:close"></div><div id="Topic91674-Area38355" class="hero outer" data-image-width="1920.0">
                        <div class="container">
                            <div class="_map lazy" style="background: url(&quot;https://n1image.hjfile.cn/zhuanti/2017/06/07/0668eb77c24e011a0b350f54f4a6d548.jpg&quot;) center 0px no-repeat;"></div>
                            <div class="_areas" style="left: -248px;">
                                <a class="none _one1" href="http://class.hujiang.com/classzt/MKTTopic_p91981?ch_source=icls_home_0_lm" target="_blank"></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!--/ko-->*@
    </div>
    @*<div id="search-header">
            <div class="search-header">
                <div class="search-wrapper clearfix">
                    <div class="course-logo">
                        <div data-bind="if: !logo()"></div><div data-bind="if: logo">
                            <!--ko with:logo-->
                            <!--<a href="/" data-bind="style:{background: images }, attr: {href: url}">

                            </a>-->
                            <a href="http://class.hujiang.com/classzt/MKTTopic_p91981?ch_campaign=cls14020&amp;ch_source=icls_qbwx_0_pcd" data-bind="attr: {href: url}"><img data-bind="attr: {src: images}" width="129" heigth="auto" src="https://n1image.hjfile.cn/zhuanti/2017/06/06/33be70bb078c60e7ed73998c12b97f29.gif"></a><!--/ko-->
                        </div>
                    </div><div class="search-panel">
                        <!--ko component:{
                        name:'search-input',
                        params: {value: searchWord,isOpenNewTag: isOpenNewTag, hotWordList: hotWordList}
                        }-->
                        <div class="search-box" data-bind="click:hidePlaceholder"><div class="search-input-wrap"><i class="hui-icon hui-icon-search"></i> <input type="text" data-bind="textInput: searchWord, event:{ blur: showPlaceholder, keyup: submitSearch}"><div class="hotWordList_top3_list" data-bind="foreach:hotWordList_top3,visible: $component.isShowPlaceholder"><a class="hotWordList_top3_item" target="_blank" data-bind="html: word, attr: {href: url}, css: {hot: isHot}, click: function() {ht.sendCustomEvent('course_ssrc',{type:'框内', content: word});return true;}" href="http://class.hujiang.com/classzt/jp">日语入门</a><a class="hotWordList_top3_item" target="_blank" data-bind="html: word, attr: {href: url}, css: {hot: isHot}, click: function() {ht.sendCustomEvent('course_ssrc',{type:'框内', content: word});return true;}" href="http://class.hujiang.com/category/12468437945">签约雅思7分</a><a class="hotWordList_top3_item" target="_blank" data-bind="html: word, attr: {href: url}, css: {hot: isHot}, click: function() {ht.sendCustomEvent('course_ssrc',{type:'框内', content: word});return true;}" href="http://class.hujiang.com/classzt/MKTTopic_p91682?ch_campaign=cls13759&amp;ch_source=icls_qbwx_0_gjcss">英语口语</a></div></div><a href="javascript:;" class="btn-search" data-bind="event: {click: searchHandler}">搜索</a></div><div class="ui-autocomplete" data-bind="foreach: autocompleteList, visible: isShow, event: {mouseover: showAutoComplete}" style="display: none;"></div><!--/ko-->
                    </div><div class="hui-select collect-select" data-bind="event: {mouseover:showOptions, mouseout: hideOptions }, css: {on: isShow}"><a class="hui-select-btn" target="_blank" href="/myclass/favorite"><i class="hui-icon hui-icon-star-solid"></i> <span>我收藏的课程</span> <i class="hui-icon hui-icon-carat-d-small"></i></a><div class="hui-select-con" data-bind="visible: isShow, html: myCollectList" style="display: none;"><div class="no-collect">您还没有收藏的班级哦~</div></div></div>
                </div>
            </div>
        </div>*@
    <div style="margin-top:30px;">

    </div>
    <div id="course-filter">
        <div style="position:relative;z-index:1;">
            <div class="wrap clearfix">
                <div class="course-multi-type clearfix">
                    <div class="course-first-category"><a href="javascript:void(0);" ng-click="clearBootCate()" class="category-text">全部课程</a></div>
                    <div class="course-category" ng-if="firstLevelCate!=null" ng-mouseenter="showFirstLevelCategory()" ng-mouseleave="hideFirstLevelCategory()">
                        <i class="hui-icon  icon-angle-right"></i>
                        <a class="category-text">
                            <span href="javascript:void(0);" ng-bind="category[firstLevelCate].cateName"></span>
                            <i class="hui-icon " ng-class="{'icon-angle-down':!isShowFirstLevelCategory,' icon-angle-up':isShowFirstLevelCategory}"></i>
                        </a>
                        <div class="course-category-list" ng-show="isShowFirstLevelCategory">
                            <a href="javascript:void(0);" ng-repeat="level1 in category" ng-click="setFirstLevelCate($index)" ng-bind="level1.cateName"></a>

                        </div>
                    </div>
                    <div class="course-category" ng-if="secondLevelCate!=null" ng-mouseenter="showSecondLevelCategory()" ng-mouseleave="hideSecondLevelCategory()">
                        <i class="hui-icon  icon-angle-right"></i>
                        <a class="category-text">
                            <span href="javascript:void(0);" ng-bind="category[firstLevelCate].childNodeList[secondLevelCate].cateName"></span>
                            <i class="hui-icon " ng-class="{'icon-angle-down':!isShowSecondLevelCategory,' icon-angle-up':isShowSecondLevelCategory}"></i>
                        </a>
                        <div class="course-category-list" ng-show="isShowSecondLevelCategory">
                            <a href="javascript:void(0);" ng-repeat="level2 in category[firstLevelCate].childNodeList" ng-click="setSecondLevelCate($index)" ng-bind="level2.cateName"></a>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="course-nav" ng-if="!isInitialCategoryFilter">
            <div>
                <ul class="course-kind">
                    <li ng-class="{'active':currentFilterIndex==null}">
                        <a ng-click="clearCategory()" href="javascript:;">全部</a>
                    </li>
                    <li ng-repeat="cate in filterCategory" ng-class="{'active':currentFilterIndex==$index}">
                        <a href="javascript:;" ng-bind="cate.cateName" ng-click="setCategory($index)"></a>
                    </li>
                </ul>
            </div>

        </div>
        <div ng-if="isInitialCategoryFilter">
            <ul class="course-category-all clearfix">
                <li ng-repeat="lv1 in category" class="course-category-li clearfix">
                    <h3><a ng-bind="lv1.cateName" ng-click="setFirstLevelCate($index)" href="javascript:void(0);"></a>：</h3>
                    <ul class="category-list">
                        <li ng-repeat="lv2 in lv1.childNodeList">
                            <a ng-click="setSecondLevelCate($index, $parent.$index)" ng-bind="lv2.cateName" href=" javascript:void(0);"></a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
    <div id="course-main">
        <div class="course-list-block clearfix" ng-if="!(isShowAddCourse ||isShowEditCourse)" id="toolbar">
            <div class="main2 clearfix fl">
                <div id="course-toolbar">
                    <div class="tool-bar clearfix">
                        <div id="courseToolbarOrderType">
                            <div class="toolbar-order-type clearfix">
                                <a href="javascript:;" ng-click="setOrderType(0)" ng-class="{'active':currentOrder==0}" class="order-type ">综合</a>
                                <a class="order-type" ng-click="setOrderType(1)" ng-class="{'active-down':currentOrder==2,'active-up':currentOrder==1}" href="javascript:;">价格 <span class="icon-wrap"><i class="hui-icon icon-angle-up"></i> <i class="hui-icon icon-angle-down"></i></span></a>
                                <a href="javascript:;" ng-click="setOrderType(3)" ng-class="{'active':currentOrder==2}" class="order-type">人气 <span class="icon-wrap"><i class="hui-icon  icon-double-angle-down"></i></span></a>
                            </div>
                        </div>
                        <div>
                            <div class="course-toolbar-filter"></div>
                        </div>

                        <div id="pages" ng-if="!isNullResult">
                            <div class="jump-page-s">
                                <i ng-class="{'active':currentPage>1}" ng-click="goPrev()" class="pre hui-icon  icon-angle-left"></i>
                                <span class="page-txt"><span ng-bind="currentPage" class="cur-index"></span> / <span ng-bind="totalPage"></span> 页</span>
                                <i ng-class="{'active':currentPage<totalPage}" ng-click="goNext()" class="next hui-icon  icon-angle-right "></i>
                            </div>
                        </div>
                        <div id="showType" ng-if="!isNullResult">
                            <i style="display: inline-block; line-height: 42px; " ng-click="setListView()" ng-class="{'act':!isCard}" class="tool-btn hui-icon icon-reorder  "></i>
                            <i style="display: inline-block; line-height: 42px; " ng-click="setCardView()" ng-class="{'act':isCard}" class="tool-btn hui-icon icon-th-large  first-btn"></i>
                        </div>
                    </div>
                </div>
                <div class="main2 clearfix fl">
                    <div ng-if="!isNullResult && !isCard">
                        <div class="course-list-block clearfix">
                            <div class="main2 clearfix fl">
                                <div>
                                    <ul class="course-list-stark clearfix">
                                        <li class="list-stark clearfix" ng-repeat="course in courseList">
                                            <a class="img-wrap preset-img" target="_blank" ng-href="{{'/course/details/'+course.CourseID}}">
                                                <img ng-src="{{'http://upimg.xueqitian.com/classimg/'+course.ClassID}}">
                                            </a>
                                            <div class="info2">
                                                <div class="course-stark-title">
                                                    <a class="title-text" target="_blank" ng-href="{{'/course/details/'+course.CourseID}}" ng-bind="course.CourseName"></a>
                                                </div>
                                                <a class="discript" target="_blank" ng-href="{{'/course/details/'+course.CourseID}}">

                                                    <span ng-bind="course.SubTitle"></span>
                                                </a>
                                                <span ng-bind="'￥'+course.DiscountPrice" class="price2"></span>
                                                <del ng-bind="'￥'+course.OriginalPrice"></del>
                                                <div class="remark">
                                                    总 <span ng-bind="course.LessonCount"></span> 课时
                                                    @*<span class="team" data-bind="text: '老师：'+teacherName">老师：沪江网校英语教学组</span>*@
                                                </div>
                                                <a target="_blank" class="detail" ng-href="{{'/course/details/'+course.CourseID}}">编辑内容</a>
                                                <a target="_blank" class="delete" ng-click="showDelModal($index)" href="javascript:;">删除课程</a>
                                                <a target="_blank" class="admin" ng-if="course.ClassID!=0" ng-href="{{'/class/admin/'+course.ClassID}}">管理课程</a>
                                                <a target="_blank" class="edit" href="javascript:void(0);" ng-click="showAddCourseForm(course.CourseID)">编辑课程</a>
                                                <a href="javascript:void(0);" class="add" ng-if="currentFilterIndex!=null" ng-click="showAddCourseForm()">添加课程</a>
                                                <a target="_blank" class="data" ng-href="{{'/studyrecord/analysis/'+course.CourseID}}">数据分析</a>
                                            </div>
                                            @*<div class="fr scalInfo">
                                                <span class="tag normal custom" data-bind="css:{'custom':$component.isCustom($data)}">
                                                    <span data-bind="html:$component.saleIcon($data)">
                                                        <img class="saleImg" src="https://n1image.hjfile.cn/classadmin/2017/06/08/fd697277d4230de7c8241afa92752af6.png" width="auto" height="25">
                                                    </span>
                                                </span>
                                            </div>*@
                                        </li>

                                    </ul>
                                </div>
                                <div class="jump-page-l">
                                    <div class="pages">
                                        <a class="prev" ng-if="currentPage>1" ng-click="goPrev()" href="javascript:void(0);">
                                            上一页
                                            <em class="arrow_pre"></em>
                                        </a>
                                        <a ng-repeat="page in pages track by $index" href="javascript:void(0);" ng-click="getByCategory(currentCateId,page,pagesize,currentOrder)" ng-bind="page" ng-class="{'currpage':currentPage==page,'otherpage':currentPage!=page&&page!='...'}">

                                        </a>

                                        <a class="next" ng-if="currentPage<totalPage" ng-click="goNext()" href="javascript:void(0);">
                                            下一页
                                            <em class="arrow_next"></em>
                                        </a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div ng-if="!isNullResult&& isCard">
                        <div class="course-list-block clearfix">
                            <div class="main2 clearfix fl">
                                <div>
                                    <ul class="course-list-card  clearfix">
                                        <li class="customSaleItem" ng-repeat="course in courseList">
                                            <a class="img-wrap preset-img" target="_blank" ng-href="{{'/course/Details/'+course.CourseID}}">
                                                <img ng-src="{{'http://upimg.xueqitian.com/classimg/'+course.ClassID}}">
   
                                            </a>
                                            <a class="course-card-title" target="_blank" ng-href="{{'/course/details/'+course.CourseID}}" ng-bind="course.CourseName">

                                            </a>
                                            <div class="info2 clearfix">
                                                <span ng-bind="'￥'+course.DiscountPrice" class="price2"></span>
                                                <del ng-bind="'￥'+course.OriginalPrice"></del>


                                            </div>
                                            <div style="float:left;">
                                                总 <span ng-bind="course.LessonCount"></span> 课时
                                            </div>

                                        </li>
                                    </ul>
                                </div>
                                <div class="jump-page-l">
                                    <div class="pages">
                                        <a class="prev" ng-if="currentPage>1" ng-click="goPrev()" href="javascript:void(0);">
                                            上一页
                                            <em class="arrow_pre"></em>
                                        </a>
                                        <a ng-repeat="page in pages track by $index" href="javascript:void(0);" ng-click="getByCategory(currentCateId,page,pagesize,currentOrder)" ng-bind="page" ng-class="{'currpage':currentPage==page,'otherpage':currentPage!=page&&page!='...'}">

                                        </a>

                                        <a class="next" ng-if="currentPage<totalPage" ng-click="goNext()" href="javascript:void(0);">
                                            下一页
                                            <em class="arrow_next"></em>
                                        </a>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                    <div ng-if="isNullResult">
                        <div class="null-list">
                            <i class="sad-face"></i>
                            <p class="tip">亲~没找到符合条件的课程~</p>
                            <a href="javascript:void(0);" ng-click="clearBootCate()" class="btn">查找其他课程</a>
                            <a href="javascript:void(0);" ng-if="currentFilterIndex!=null" ng-click="showAddCourseForm()" class="btn">添加课程</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="addCourseForm" ng-show="isShowAddCourse ||isShowEditCourse" class="course-list-block clearfix">
            <div class="course-form-wrapper">
                <div class="detail">
                    <form name="myForm" novalidate>


                        <div class="form-group">

                            <label for="nick" class="control-label">课程名称</label>
                            <div class="control-target">
                                <input type="text" class="form-control" style="width:300px" ng-minlength="5" ng-maxlength="30" ng-model="courseName" required name="courseName" placeholder="输入课程名称" spellcheck="false">
                                <div class="tip tip-custome" style="display: none;">
                                    <span><em></em></span>
                                    <p>课程名称不能超过15个字</p>
                                </div>
                                <span style="color:red" ng-show="myForm.courseName.$dirty && myForm.courseName.$invalid">
                                    <span ng-show="myForm.courseName.$error.required">课程名称是必须的。</span>
                                    <span ng-show="myForm.courseName.$error.minlength">课程名称不能小于5位。</span>
                                    <span ng-show="myForm.courseName.$error.maxlength">课程名称不能大于15位。</span>
                                </span>

                            </div>


                        </div>
                        <div class="form-group">

                            <label for="nick" class="control-label">副标题</label>
                            <div class="control-target">
                                <input type="text" class="form-control" style="width:300px" ng-minlength="5" ng-maxlength="50" ng-model="subTitle" id="subTitle" required name="subTitle" placeholder="输入副标题" spellcheck="false">
                                <div class="tip tip-custome" style="display: none;">
                                    <span><em></em></span>
                                    <p>副标题不能超过25个字</p>
                                </div>

                            </div>


                        </div>
                        <div class="form-group">

                            <label for="nick" class="control-label">课 时 数</label>
                            <div class="control-target">
                                <input type="number" class="form-control" style="width:150px" ng-model="lessonCount" id="lessonCount" name="lessonCount" placeholder="输入课时数" spellcheck="false">
                                <div class="tip tip-custome" style="display: none;">
                                    <span><em></em></span>
                                    <p>课时数不能小于零</p>
                                </div>

                            </div>


                        </div>
                        <div class="form-group">

                            <label for="nick" class="control-label">课程介绍</label>
                            <div class="control-target">
                                <textarea id="description" name="description" ng-model="description"></textarea>

                            </div>


                        </div>
                        <div class="form-group">

                            <label for="nick" class="control-label">适合对象</label>
                            <div class="control-target">
                                <textarea id="rightfor" name="rightfor" ng-model="rightfor" ></textarea>

                            </div>


                        </div>

                        <div class="form-group">

                            <label for="nick" class="control-label">学习目标</label>
                            <div class="control-target">
                                <textarea id="purpose" name="purpose" ng-model="purpose"></textarea>

                            </div>


                        </div>
                        <div class="form-group">
                            <div class="btn-wrapper">
                                <button ng-click="addCourse()" ng-if="isShowAddCourse" class="btn">创建课程</button>
                                <button ng-click="editCourse()" ng-if="isShowEditCourse" class="btn">确认修改</button>
                                <a href="javascript:void(0);" ng-click="backToList()" class="btn">返回列表</a>
                            </div>


                        </div>
                    </form>
                </div>

            </div>
        </div>
        
    </div>
    <div ng-show="isShowModal" class="ng-hide">
    <div id="g_all"></div>
    <div id="g_box" style="z-index: 1; position: fixed; top: 119.5px; left: 445px;">
        <div id="g_title">
            提示
            <span class="close" ng-click="hideModal()">X</span>
        </div>
        <div id="g_cont">
            <i class="confirm"></i>
            <span id="g_msg">确定要删除<span ng-bind="courseList[delIndex].CourseName"></span>课程吗</span>
        </div>
        <div id="g_buttom">
            <div id="g_button">
                <a class="butt" id="ok" ng-click="delCourse()">确定</a>
                <a class="butt" id="false" ng-click="hideModal()">取消</a>
            </div>
        </div>
    </div>

</div>

    <div ng-show="isShowDelResult" class="ng-hide">
        <div id="g_all"></div>
        <div id="g_box" style="z-index: 1; position: fixed; top: 119.5px; left: 445px;">
            <div id="g_title">
                提示
                <span class="close" ng-click="hideModal()">X</span>
            </div>
            <div id="g_cont">
                <i ng-class="{'ok':isDelOkResult,'fail':!isDelOkResult}"></i>
                <span id="g_msg" ng-bind="isShowDelResult?'删除成功':'删除失败，请重试！'"></span>
            </div>
            <div id="g_buttom">
                <div id="g_button">
                    <a class="butt" id="ok" ng-click="hideModal()">确定</a>
                   
                </div>
            </div>
        </div>

    </div>

    <div ng-show="isShowAddResult" class="ng-hide">
        <div id="g_all"></div>
        <div id="g_box" style="z-index: 1; position: fixed; top: 119.5px; left: 445px;">
            <div id="g_title">
                提示
                <span class="close" ng-click="hideModal()">X</span>
            </div>
            <div id="g_cont">
                <i ng-class='fail'></i>
                <span id="g_msg" ng-if="isShowAddCourse">添加课程不成功，请重试</span>
                <span id="g_msg" ng-if="isShowEditCourse">修改课程不成功，请重试</span>
            </div>
            <div id="g_buttom">
                <div id="g_button">
                    <a class="butt" id="ok" ng-click="hideModal()">确定</a>

                </div>
            </div>
        </div>

    </div>
</div>


@Html.Partial("../Shared/Tool")
@section Scripts {

    <script type="text/javascript">
        
        seajs.use("modules/course/admin");
    </script>
}